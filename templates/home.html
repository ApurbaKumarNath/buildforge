<!--akn -->
{% extends "base.html" %}
{% load static %}

{% block content %}
<!-- Hero Section -->
{% if not user.is_authenticated %}
<div class="hero-section" style="--hero-bg: url('{% static 'images/hero_bg.png' %}');">
    <div class="hero-content">
        <h1>Build Your Dream Machine</h1>
        <p>The ultimate workbench for PC enthusiasts. Plan, share, and trade components with a community of builders.
        </p>
        
        <div class="hero-actions">
            <a href="{% url 'users:register' %}" class="btn btn-primary btn-lg">Start Building</a>
            <a href="{% url 'users:login' %}" class="btn btn-outline-light btn-lg">Login</a>
        </div>
        {% else %}

        {% endif %}
    </div>
</div>

<div class="main-content">
    {% if user.is_authenticated %}
    <div class="dashboard-header-modern">
        <h2>Welcome back, {{ user.username }}!</h2>
    </div>

    <!-- Feature Grid -->
    <div class="features-grid">
        <div class="feature-card">
            <div class="feature-icon">ğŸ”</div>
            <h3>Component Catalog</h3>
            <p>Browse thousands of parts with detailed specs to find exactly what you need.</p>
            <a href="{% url 'catalog:chooser' %}" class="feature-link">Open Catalog &rarr;</a>
        </div>

        <div class="feature-card">
            <div class="feature-icon">ğŸ“š</div>
            <h3>Build Guides</h3>
            <p>Follow expert-curated guides or create your own to share with the world.</p>
            <a href="{% url 'builds:guides' %}" class="feature-link">View Guides &rarr;</a>
        </div>

        <div class="feature-card">
            <div class="feature-icon">ğŸ›’</div>
            <h3>Marketplace</h3>
            <p>Buy and sell pre-loved components safely within the community.</p>
            <a href="{% url 'marketplace:list' %}" class="feature-link">Visit Market &rarr;</a>
        </div>

        <div class="feature-card">
            <div class="feature-icon">â­</div>
            <h3>Wishlist</h3>
            <p>Track price drops and save components for your future dream build.</p>
            <a href="{% url 'builds:wishlist' %}" class="feature-link">My Wishlist &rarr;</a>
        </div>
    </div>

    <!-- User's Builds Section -->
    <!-- Your Builds Section -->
    <div style="margin-top: 2.5em;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1em;">
            <h2>Your Builds</h2>
            <!-- The Search Input Field -->
            <input type="search" 
                name="q" 
                placeholder="Search your builds..."
                style="padding: 0.5em; border-radius: 5px; border: 1px solid #ced4da; width: 300px;"
                hx-get="{% url 'home' %}"
                hx-trigger="keyup changed delay:300ms, search"
                hx-target="#build-list-container"
                hx-select="#build-list-container"
                hx-swap="outerHTML">
        </div>

        <!-- The Scrollable Container -->
        <div id="build-list-container" style="max-height: 600px; overflow-y: auto; padding: 1em; border: 1px solid #dee2e6; border-radius: 8px; background: #f8f9fa;">
            {% include 'builds/partials/build_list.html' %}
        </div>
    </div>

    {% else %}
    <!-- Features for Guest -->
    <div class="features-grid">
        <div class="feature-card">
            <div class="feature-icon">ğŸš€</div>
            <h3>Performance First</h3>
            <p>Optimize your build with compatibility checks and performance estimates.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">ğŸ¤</div>
            <h3>Community Driven</h3>
            <p>Join thousands of builders sharing knowledge and components.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">ğŸ›¡ï¸</div>
            <h3>Safe Trading</h3>
            <p>Our marketplace is built for enthusiasts, by enthusiasts.</p>
        </div>
    </div>
    {% endif %}
</div>

<!-- New Build Form Section -->
{% if user.is_authenticated %}
<div class="form-container card" style="margin-top: 2em;">

    <h3>Start a New Build</h3>
    <form method="post" action="{% url 'home' %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-primary">Create and Go to Workbench</button>
    </form>
</div>

{% endif %}
{% endblock %}