<!-- akn -->


<!-- templates/home.html -->
{% extends "base.html" %}

{% block content %}
<style>
    .dashboard-header {
        text-align: center;
        margin-bottom: 2.5em;
        padding: 2em 1em;
        background-color: #f8f9fa;
        border-radius: 12px;
        border: 1px solid #dee2e6;
    }
    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 1.5em;
        margin-top: 2em;
    }
    .card {
        background: #fff;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        padding: 1.5em;
        display: flex;
        flex-direction: column;
    }
    .card h3 { margin-top: 0; }
    .card p { color: #6c757d; flex-grow: 1; }
    .card-actions { margin-top: 1em; }
    .btn { text-decoration: none; padding: 0.6em 1.2em; border-radius: 5px; font-weight: bold; display: inline-block; text-align: center; border: none; cursor: pointer; }
    .btn-primary { background-color: #007bff; color: white; }
    .btn-secondary { background-color: #6c757d; color: white; }
    
    /* Styles for the new build cards */
    .build-card-content { flex-grow: 1; }
    .build-card-actions { display: flex; flex-wrap: wrap; gap: 0.5em; margin-top: 1em; }

    /* Modern Form Styles */
    .form-container { grid-column: 1 / -1; margin-top: 2.5em; }
    .form-container form p { margin-bottom: 1em; }
    .form-container label { display: block; margin-bottom: 0.5em; font-weight: bold; color: #495057; }
    .form-container input[type="text"], .form-container textarea { width: 100%; padding: 0.75em; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; }
</style>

<div class="dashboard-header">
    <h1>Welcome, {{ user.username|default:'Guest' }}!</h1>
    <p>Your central hub for creating, managing, and sharing dream PC builds.</p>
</div>

<!-- This section will only be shown to logged-in users -->
{% if user.is_authenticated %}

    <!-- Main Navigation Cards -->
    <div class="dashboard-grid">

        <div class="card">
            <h3>Component Catalog</h3>
            <p>Browse and filter thousands of PC parts to find the perfect components for your next build.</p>
            <div class="card-actions">
                <!-- This link will eventually point to Risalat's catalog page. -->
                <!-- For now, we use a placeholder '#'. -->
                <a href="#" class="btn btn-primary">Browse Catalog</a>
            </div>
        </div>

        <div class="card">
            <h3>Curated Guides</h3>
            <p>New to PC building? Explore pre-configured guides to get a great starting point.</p>
            <div class="card-actions">
                <a href="{% url 'builds:guides' %}" class="btn btn-primary">Explore Guides</a>
            </div>
        </div>
        <div class="card">
            <h3>Your Wishlist</h3>
            <p>Keep track of all your favorite parts for future builds or upgrades.</p>
            <div class="card-actions">
                <a href="#" class="btn btn-primary">View Wishlist</a>
            </div>
        </div>
        <div class="card">
            <h3>Community Marketplace</h3>
            <p>Buy and sell used components with other enthusiasts on the platform.</p>
            <div class="card-actions">
                <a href="#" class="btn btn-primary">Go to Marketplace</a>
            </div>
        </div>
    </div>

    <!-- Your Builds Section -->
    <div style="margin-top: 2.5em;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1em;">
            <h2>Your Builds</h2>
            <!-- The Search Input Field -->
            <input type="search" 
                name="q" 
                placeholder="Search your builds..."
                style="padding: 0.5em; border-radius: 5px; border: 1px solid #ced4da; width: 300px;"
                hx-get="{% url 'home' %}"
                hx-trigger="keyup changed delay:300ms, search"
                hx-target="#build-list-container"
                hx-select="#build-list-container"
                hx-swap="outerHTML">
        </div>

        <!-- The Scrollable Container -->
        <div id="build-list-container" style="max-height: 600px; overflow-y: auto; padding: 1em; border: 1px solid #dee2e6; border-radius: 8px; background: #f8f9fa;">
            <!-- We include the new partial here for the initial page load -->
            {% include 'builds/partials/build_list.html' %}
        </div>
    </div>

    <!-- New Build Form Section -->
    <div class="form-container card">
        <h3>Start a New Build</h3>
        <form method="post" action="{% url 'home' %}">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">Create and Go to Workbench</button>
        </form>
    </div>

{% else %}
    <!-- This section is shown to logged-out users -->
    <div class="card" style="text-align: center; margin-top: 2em;">
        <h3>Welcome to BuildForge!</h3>
        <p>The ultimate workshop for PC enthusiasts. Design, validate, and share your dream PC builds.</p>
        <div class="card-actions" style="justify-content: center;">
            <a href="{% url 'users:login' %}" class="btn btn-primary">Login</a>
            <a href="{% url 'users:register' %}" class="btn btn-secondary">Register Now</a>
        </div>
    </div>
{% endif %}

{% endblock %}
<!-- akn -->