<!-- templates/base.html -->
{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BuildForge</title>

    <script src="https://unpkg.com/htmx.org@1.9.12"
        integrity="sha384-ujb1lZYygJmzgSwoxRggbCHcjc0rB2XoQrxeTUQyRjrOnlCoYta87iKBWq3EsdM2"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>

<body>
    <nav>
        <div class="nav-left">
            <div class="nav-brand">
                <a href="{% url 'home' %}">BuildForge</a>
            </div>
        </div>

        <div class="nav-center nav-links">
            <a href="{% url 'catalog:chooser' %}">Catalog</a>
            <a href="{% url 'builds:guides' %}">Guides</a>
            <a href="{% url 'marketplace:list' %}">Marketplace</a>
        </div>

        <div class="nav-right">
            {% if user.is_authenticated %}
            <div class="nav-links">
                <a href="{% url 'builds:wishlist' %}">Wishlist</a>
            </div>
            <div class="nav-user-menu">
                <a href="{% url 'users:profile' user.username %}" class="nav-user-link">
                    {% if user.avatar %}
                    <img src="{{ user.avatar.url }}" alt="{{ user.username }}" class="nav-avatar">
                    {% else %}
                    <div class="nav-avatar-placeholder">{{ user.username|first|upper }}</div>
                    {% endif %}
                    <span class="nav-username">{{ user.username }}</span>
                </a>
                <div class="nav-dropdown">
                    <a href="{% url 'users:profile' user.username %}">View Profile</a>
                    <a href="{% url 'users:profile_edit' %}">Edit Profile</a>
                    <div class="dropdown-divider"></div>
                    <form method="post" action="{% url 'users:logout' %}" style="margin: 0;">
                        {% csrf_token %}
                        <button type="submit"
                            style="color: var(--danger); background: none; border: none; padding: 0.75rem 1rem; cursor: pointer; width: 100%; text-align: left; font-size: 0.95em;">Logout</button>
                    </form>
                </div>
            </div>
            {% else %}
            <div class="nav-auth-buttons">
                <a href="{% url 'users:login' %}" class="btn btn-outline"
                    style="padding: 0.4rem 0.8rem; font-size: 0.9em;">Login</a>
                <a href="{% url 'users:register' %}" class="btn btn-primary"
                    style="padding: 0.4rem 0.8rem; font-size: 0.9em;">Register</a>
            </div>
            {% endif %}
        </div>
    </nav>

    <main class="main-content">
        <!-- This block will be replaced by the content of child templates -->
        {% block content %}
        {% endblock %}
    </main>

    <script>
        function copyToClipboard(textToCopy, buttonElement) {
            // The Clipboard API is the modern and secure way to copy text.
            navigator.clipboard.writeText(textToCopy).then(function () {
                // Success feedback!
                const originalText = buttonElement.innerText;
                buttonElement.innerText = 'Copied!';
                buttonElement.style.backgroundColor = '#10b981'; // Green color from new palette

                // Revert the button back to its original state after 2 seconds.
                setTimeout(function () {
                    buttonElement.innerText = originalText;
                    buttonElement.style.backgroundColor = ''; // Revert to original color
                }, 2000);
            }, function (err) {
                // Error feedback (less common, but good to have)
                alert('Could not copy text: ', err);
            });
        }
    </script>
</body>

</html>
<!-- akn -->