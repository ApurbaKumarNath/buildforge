<!-- templates/catalog/component_list.html -->
{% extends "base.html" %}

{% block content %}
<style>
    .page-header { text-align: center; margin-bottom: 2.5em; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5em; }
    .card { background: #fff; border: 1px solid #dee2e6; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); padding: 1.5em; display: flex; flex-direction: column; }
    .card h4 { margin-top: 0; }
    .card-price { font-size: 1.2em; font-weight: bold; color: #28a745; margin: 0.5em 0; }
    .card-actions { margin-top: auto; }
    .btn { text-decoration: none; padding: 0.6em 1.2em; border-radius: 5px; font-weight: bold; display: inline-block; text-align: center; border: none; cursor: pointer; }
    .btn-secondary { background-color: #6c757d; color: white; }

    
    .filter-bar { 
        display: flex; 
        justify-content: center; 
        gap: 1em; 
        margin-bottom: 2em; 
        width: 100%; /* Changed from 10% to 100% */
        max-width: 900px; /* Optional: keeps the bar from getting too wide on desktop */
        margin-left: auto;
        margin-right: auto;
    }

    .search-bar { 
        flex: 3; /* Takes up 3x more space than the sort dropdown */
    }

    #sort-select { 
        flex: 1; /* Takes up less space */
        min-width: 180px; /* Prevents it from becoming too small to read */
        cursor: pointer;
    }

    .filter-bar input, .filter-bar select { 
        padding: 0.75em; 
        border-radius: 5px; 
        border: 1px solid #ced4da; 
        box-sizing: border-box;  
    }
</style>

<div class="page-header">
    <h1>List of {{ component_type_display }}s</h1>
</div>

<div class="filter-bar">
    <!-- Search Bar (Now Flexible and Bigger) -->
    <input class="search-bar"
           type="search" 
           name="q" 
           placeholder="Search by name or manufacturer..."
           value="{{ search_query|default:'' }}"
           hx-get="{% url 'catalog:component_list' component_type_slug %}"
           hx-trigger="keyup changed delay:300ms, search"
           hx-target="#component-grid-container"
           hx-swap="innerHTML"
           hx-include="[name='sort']">

    <!-- Sort Dropdown (Now Smaller) -->
    <select id="sort-select" name="sort"
            hx-get="{% url 'catalog:component_list' component_type_slug %}"
            hx-trigger="change"
            hx-target="#component-grid-container"
            hx-swap="innerHTML"
            hx-include="[name='q']">
        <option value="name" {% if sort_order == 'name' %}selected{% endif %}>Name (A-Z)</option>
        <option value="price_asc" {% if sort_order == 'price_asc' %}selected{% endif %}>Price (Low to High)</option>
        <option value="price_desc" {% if sort_order == 'price_desc' %}selected{% endif %}>Price (High to Low)</option>
    </select>
</div>

<div id="component-grid-container">
    {% include 'catalog/partials/component_grid.html' %}
</div>
{% endblock %}